// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model Organisations {
  id             String @id @default(cuid())
  organisationId String @unique

  // org info
  name String?

  leads Leads[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Users {
  id     String @id @default(cuid())
  userId String @unique

  // user info
  name   String?
  email  String?
  avatar String?

  assignedLeads Leads[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model OrganisationUser {
  id             String @id @default(cuid())
  userId         String
  organisationId String

  @@unique([userId, organisationId])
}

enum LeadStatus {
  IN_PROGRESS
  SUCCESSFUL
  REJECTED
  WARM
}

model Leads {
  id             String        @id @default(cuid())
  organisationId String
  organisation   Organisations @relation(fields: [organisationId], references: [organisationId])

  //  general details
  leadOn String
  source String
  status LeadStatus @default(IN_PROGRESS)

  // lead info
  mobileNo String?
  email    String?
  website  String?
  name     String?

  // other details
  nextFlowup String?
  value      String?
  notes      String? @db.Text

  assignedToId String
  assignedTo   Users  @relation(fields: [assignedToId], references: [userId])

  isArchived Boolean
  isDeleted  Boolean

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
